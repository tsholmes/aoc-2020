package main

import (
	"fmt"

	"github.com/tsholmes/aoc-2020"
)

func main() {
	part1()
	part2()
}

func revmask(mask int) int {
	res := 0
	for i := 0; i < 10; i++ {
		if (mask & (1 << i)) != 0 {
			res = res | (1 << (9 - i))
		}
	}
	return res
}

func part1() {
	secs := aoc.LineSections(input)
	tileMap := map[int][]string{}
	for _, sec := range secs {
		var num int
		fmt.Sscanf(sec[0], "Tile %d", &num)
		tileMap[num] = sec[1:]
	}
	type tileSum struct {
		num   int
		edges [4]int
	}

	edges := map[int][]tileSum{}
	var alltiles []tileSum
	for tnum, tile := range tileMap {
		var masks [4]int
		for i, edge := range [][4]int{{0, 0, 1, 0}, {9, 0, 0, 1}, {9, 9, -1, 0}, {0, 9, 0, -1}} {
			x, y := edge[0], edge[1]
			mask := 0
			for j := 0; j < 10; j++ {
				xj, yj := x+edge[2]*j, y+edge[3]*j
				if tile[xj][yj] == '#' {
					mask = mask | (1 << j)
				}
			}
			masks[i] = mask
		}
		sum := tileSum{num: tnum, edges: masks}
		alltiles = append(alltiles, sum)
		for _, m := range masks[:] {
			edges[m] = append(edges[m], sum)
		}
		m0, m1, m2, m3 := masks[0], masks[1], masks[2], masks[3]
		r0, r1, r2, r3 := revmask(masks[0]), revmask(masks[1]), revmask(masks[2]), revmask(masks[3])

		masks = [4]int{r0, m3, r2, m1}
		sum = tileSum{num: tnum, edges: masks}
		alltiles = append(alltiles, sum)
		for _, m := range masks[:] {
			edges[m] = append(edges[m], sum)
		}
		masks = [4]int{m2, r1, m0, r3}
		sum = tileSum{num: tnum, edges: masks}
		alltiles = append(alltiles, sum)
		for _, m := range masks[:] {
			edges[m] = append(edges[m], sum)
		}
		masks = [4]int{r2, r3, r0, r1}
		sum = tileSum{num: tnum, edges: masks}
		alltiles = append(alltiles, sum)
		for _, m := range masks[:] {
			edges[m] = append(edges[m], sum)
		}
	}
	mtmap := map[int]map[int]bool{}
	tedges := map[int][4]int{}
	for tnum, tile := range tileMap {
		var masks [4]int
		for i, edge := range [][4]int{{0, 0, 1, 0}, {9, 0, 0, 1}, {9, 9, -1, 0}, {0, 9, 0, -1}} {
			x, y := edge[0], edge[1]
			mask := 0
			for j := 0; j < 10; j++ {
				xj, yj := x+edge[2]*j, y+edge[3]*j
				if tile[xj][yj] == '#' {
					mask = mask | (1 << j)
				}
			}
			if _, ok := mtmap[mask]; !ok {
				mtmap[mask] = map[int]bool{}
				mtmap[revmask(mask)] = map[int]bool{}
			}
			mtmap[mask][tnum] = true
			mtmap[revmask(mask)][tnum] = true
			masks[i] = mask
		}
		tedges[tnum] = masks
	}

	res := 1
	for tnum, masks := range tedges {
		bedges := 0
		for _, m := range masks[:] {
			seen := map[int]bool{}
			mm, ok := mtmap[m]
			if ok {
				for t2 := range mm {
					if t2 != tnum {
						seen[t2] = true
					}
				}
			}
			mm, ok = mtmap[revmask(m)]
			if ok {
				for t2 := range mm {
					if t2 != tnum {
						seen[t2] = true
					}
				}
			}
			if len(seen) == 0 {
				bedges++
			}
		}
		if bedges >= 2 {
			res *= tnum
		}
	}
	fmt.Println(res)

	if true {
		return
	}
	type tileUse struct {
		offset int
		sum    tileSum
	}

	for _, rows := range []int{2, 3, 4, 6, 9, 12} {
		maxCount := 0
		used := map[int]bool{}
		var search func(tiles [144]tileUse, count int) ([144]tileUse, bool)
		search = func(tiles [144]tileUse, count int) ([144]tileUse, bool) {
			if count > maxCount {
				maxCount = count
			}
			x, y := count/rows, count%rows
			lmask, umask := -1, -1
			vtiles := alltiles
			if y > 0 {
				tuse := tiles[count-1]
				umask = revmask(tuse.sum.edges[tuse.offset])
				vtiles = edges[umask]
			}
			if x > 0 {
				tuse := tiles[count-rows]
				lmask = revmask(tuse.sum.edges[(tuse.offset+1)%4])
				vtiles = edges[lmask]
			}
			for _, ntile := range vtiles {
				if used[ntile.num] {
					continue
				}
				for o := 0; o < 4; o++ {
					tl := ntile.edges[(o+2)%4]
					tu := ntile.edges[(o+3)%4]
					if (lmask == -1 || lmask == tl) && (umask == -1 || umask == tu) {
						used[ntile.num] = true
						tiles[count] = tileUse{offset: o, sum: ntile}
						rtiles, ok := search(tiles, count+1)
						used[ntile.num] = false
						if ok {
							return rtiles, true
						}
					}
				}
			}
			return tiles, false
		}

		res, ok := search([144]tileUse{}, 0)
		_ = res
		fmt.Println(ok, maxCount)
	}
}

func part2() {
	secs := aoc.LineSections(input)
	tileMap := map[int][]string{}
	for _, sec := range secs {
		var num int
		fmt.Sscanf(sec[0], "Tile %d", &num)
		tileMap[num] = sec[1:]
	}
	type tileSum struct {
		num   int
		edges [4]int
	}

	edges := map[int][]tileSum{}
	var alltiles []tileSum
	for tnum, tile := range tileMap {
		var masks [4]int
		for i, edge := range [][4]int{{0, 0, 1, 0}, {9, 0, 0, 1}, {9, 9, -1, 0}, {0, 9, 0, -1}} {
			x, y := edge[0], edge[1]
			mask := 0
			for j := 0; j < 10; j++ {
				xj, yj := x+edge[2]*j, y+edge[3]*j
				if tile[xj][yj] == '#' {
					mask = mask | (1 << j)
				}
			}
			masks[i] = mask
		}
		sum := tileSum{num: tnum, edges: masks}
		alltiles = append(alltiles, sum)
		for _, m := range masks[:] {
			edges[m] = append(edges[m], sum)
		}
		// m0, m1, m2, m3 := masks[0], masks[1], masks[2], masks[3]
		r0, r1, r2, r3 := revmask(masks[0]), revmask(masks[1]), revmask(masks[2]), revmask(masks[3])

		masks = [4]int{r2, r1, r0, r3}
		sum = tileSum{num: tnum, edges: masks}
		for _, m := range masks[:] {
			edges[m] = append(edges[m], sum)
		}
	}

	cornerTiles := map[int]bool{}
	edgeTiles := map[int]bool{}

	mtmap := map[int]map[int]bool{}
	tedges := map[int][4]int{}
	for tnum, tile := range tileMap {
		var masks [4]int
		for i, edge := range [][4]int{{0, 0, 1, 0}, {9, 0, 0, 1}, {9, 9, -1, 0}, {0, 9, 0, -1}} {
			x, y := edge[0], edge[1]
			mask := 0
			for j := 0; j < 10; j++ {
				xj, yj := x+edge[2]*j, y+edge[3]*j
				if tile[xj][yj] == '#' {
					mask = mask | (1 << j)
				}
			}
			if _, ok := mtmap[mask]; !ok {
				mtmap[mask] = map[int]bool{}
				mtmap[revmask(mask)] = map[int]bool{}
			}
			mtmap[mask][tnum] = true
			mtmap[revmask(mask)][tnum] = true
			masks[i] = mask
		}
		tedges[tnum] = masks
	}

	for tnum, masks := range tedges {
		bedges := 0
		for _, m := range masks[:] {
			seen := map[int]bool{}
			mm, ok := mtmap[m]
			if ok {
				for t2 := range mm {
					if t2 != tnum {
						seen[t2] = true
					}
				}
			}
			mm, ok = mtmap[revmask(m)]
			if ok {
				for t2 := range mm {
					if t2 != tnum {
						seen[t2] = true
					}
				}
			}
			if len(seen) == 0 {
				bedges++
			}
		}
		if bedges >= 2 {
			cornerTiles[tnum] = true
		} else if bedges == 1 {
			edgeTiles[tnum] = true
		}
	}

	type tileUse struct {
		offset int
		sum    tileSum
	}

	fmt.Println(cornerTiles, len(edgeTiles))

	for _, rows := range []int{ /*2, 3, 4, 6, 9,*/ 12} {
		maxCount := 0
		used := map[int]bool{}
		var search func(tiles [144]tileUse, count int) ([144]tileUse, bool)
		search = func(tiles [144]tileUse, count int) ([144]tileUse, bool) {
			if count > 0 {
				fmt.Println(count, tiles[count-1].sum.num)
			}
			if count > maxCount {
				maxCount = count
			}
			if count == 144 {
				return tiles, true
			}
			x, y := count/rows, count%rows
			lmask, umask := -1, -1
			vtiles := alltiles
			if y > 0 {
				tuse := tiles[count-1]
				umask = revmask(tuse.sum.edges[tuse.offset])
				vtiles = edges[umask]
			}
			if x > 0 {
				tuse := tiles[count-rows]
				lmask = revmask(tuse.sum.edges[(tuse.offset+1)%4])
				vtiles = edges[lmask]
			}
			for _, ntile := range vtiles {
				if used[ntile.num] {
					continue
				}
				if (x == 0 || x == rows-1) && (y == 0 || y == rows-1) && !cornerTiles[ntile.num] {
					continue
				}
				if (((x == 0 || x == rows-1) && y != 0 && y != rows-1) || ((y == 0 || y == rows-1) && x != 0 && x != rows-1)) && !edgeTiles[ntile.num] {
					continue
				}
				for o := 0; o < 4; o++ {
					tl := ntile.edges[(o+2)%4]
					tu := ntile.edges[(o+3)%4]
					if (lmask == -1 || lmask == tl) && (umask == -1 || umask == tu) {
						used[ntile.num] = true
						tiles[count] = tileUse{offset: o, sum: ntile}
						rtiles, ok := search(tiles, count+1)
						used[ntile.num] = false
						if ok {
							return rtiles, true
						}
					}
				}
			}
			return tiles, false
		}

		res, ok := search([144]tileUse{}, 0)
		_ = res
		fmt.Println(ok, maxCount)
	}
}

const input = `Tile 2297:
###.###..#
.....#.#.#
......##.#
..........
##....#...
#.#...##.#
##...#..##
#...#.####
#.##.###..
####..#.##

Tile 2459:
..#.#.#..#
..###...#.
#....#.#.#
...#.#.#..
#..#.....#
###.#...##
.#....#...
##....#...
...#......
##....#.##

Tile 3547:
.#..##.##.
....####..
#....#..#.
#......#.#
...####.##
...#.#....
...##..#.#
###.###...
#....#...#
##.###...#

Tile 1741:
###.###...
#.#.#....#
#..#...###
###...##.#
.....#..#.
#........#
...#.....#
.........#
....#.#..#
#####.#.##

Tile 2237:
#....#..##
...#.....#
##.......#
.#........
......#..#
##..######
....#...##
#...#.#..#
...#......
.#.##..##.

Tile 1889:
#..###.###
#.####...#
....##.#.#
...#.#...#
..........
#...#.##.#
#..#.##.##
#...#.....
###.#..#.#
.#..#..##.

Tile 3061:
##.####...
#.##...#..
#.....##..
#.....#..#
#.....#.#.
#.#......#
.#.##....#
.#.......#
#.#.#...#.
#...#...##

Tile 1907:
#...#.###.
...#..#..#
##.###...#
#....#...#
##...#..##
.###......
.#..#..##.
#....##..#
.#....##..
.#...#####

Tile 1193:
#..##..##.
...#.....#
......#...
.#......#.
.#.##...##
..#..#...#
#.#.....##
...#.#....
#..##.....
####..##..

Tile 3733:
###.##...#
#......#..
##....#...
##..###...
##.##.###.
#........#
#....#...#
.....###..
.#......##
....##..##

Tile 1327:
#####.##.#
..#.....##
.#...#..#.
#..#..##.#
..#.......
......#...
#...#..###
##........
......#...
.###.#.###

Tile 3907:
..#..##.##
#......##.
...##....#
.........#
.###..#...
#.#.#.....
#..#.....#
.#..##.#.#
....#....#
.#.#..#.##

Tile 3019:
###......#
#...#..#.#
#..#.#....
#..#.....#
.....###..
.........#
..#.......
##.#.....#
#.....#.#.
...##...##

Tile 1277:
..####.##.
..........
...#...#.#
......#...
#..#.#...#
.#...#...#
##....#.##
..#.....##
#.......#.
#.....##..

Tile 2659:
##...#...#
..#....###
.#.#..#..#
....#.##..
.....#...#
#.#.......
..........
....##..##
..........
.#..####.#

Tile 3673:
..###..#..
..#.......
..........
##....#.#.
....#..#..
...#......
#..#...#.#
......#...
..##.#...#
#.##......

Tile 3329:
#....#..#.
#....#...#
##.#.....#
.......#.#
#..##.#.#.
#...##....
##.#.##...
#........#
.#...##.#.
.####...#.

Tile 2383:
#...####.#
##......##
.......###
#.........
..#..#..##
.#.####.#.
.#..##...#
#.#..#....
..#.#..#.#
......####

Tile 2377:
...#....#.
....#..#.#
.#.......#
#....##...
..#.####..
#.......#.
.......#..
....#...##
.......#..
##..#..#..

Tile 1931:
###.#...##
...##...##
.#.#..#.#.
#...#.##.#
.........#
##........
...#..#...
......#.#.
#...#...##
##..#..#..

Tile 3911:
#..####...
...##..#..
##.....#..
###.....##
..........
...#..##.#
#......###
#.#....#.#
#..#.###.#
.....#####

Tile 3251:
##.##.#.#.
#....#.#..
#....#...#
#.#...#.#.
#.......##
..#....#..
..##...#..
.#.#..#..#
..#.#..#.#
#..#......

Tile 1879:
##.#.#.###
...#...#.#
.#.#.#....
#..#.##..#
#.......##
#........#
..##......
.#.....#.#
...#....##
.###.#.###

Tile 2819:
#.#....###
..#....##.
#.#.......
..#.#..#.#
.#.#......
#...#.....
.#...#....
.#..#.##..
.###..#.##
...##.#.##

Tile 2351:
..#..##.#.
#.#....#..
#.##...##.
........##
#....#....
...#....#.
#.#.##....
.##.#.##.#
.##.......
###..#..##

Tile 2801:
#.#....#..
#......##.
.#..#..#..
....#...##
....##.#..
##........
#.##.#.#..
.##...#...
..........
###..##.#.

Tile 1873:
#.#.....##
#........#
#........#
.#........
........#.
......#.#.
...#......
....#.....
#.#.......
#.#...#..#

Tile 2437:
###.##..#.
#.##..##..
..#.#...##
#.....##.#
##.......#
....#..#..
#..##...#.
..#.##....
......##..
..##..#...

Tile 2579:
#..##.####
##.#...#.#
.##..#...#
##.....#..
###.......
#....#....
#..#.#...#
#...#...##
.#.#....##
#.#..#....

Tile 1609:
.#..##.##.
#..##....#
#....#..##
#....#.###
#.####....
##..##.#..
..#.#...#.
...##....#
#...##...#
##..#..###

Tile 3929:
..###...##
##........
##.##....#
..#..#.#..
..#.#....#
#.##..#...
.##......#
##.#.....#
#.......##
..##.##...

Tile 1487:
..####.#..
#.#.#...#.
.........#
#...#.....
#......#..
#......#.#
###......#
#..#.###..
.......#.#
#..##..###

Tile 1811:
..#....##.
..#.#...#.
.......#..
...#.#...#
#..##...#.
..........
#...#...##
....#....#
#.#...#...
.#.#..###.

Tile 1747:
#..##.#.#.
#..#......
..#.###..#
..#.#.....
#.##.....#
#........#
##...###..
...#...#..
..#.#..#.#
#..##.###.

Tile 3779:
#.#####...
...#.....#
..#.#....#
.#.#......
##.....##.
##.....###
#.##.#.###
.#.#.###.#
....#.....
......#...

Tile 3767:
.##.##.###
#.#.....#.
#...#..##.
###....##.
.....##...
..#.......
......#..#
....#..#..
#......#..
##..#.#...

Tile 1871:
.#.###...#
##...###..
#..#...###
......#..#
#....####.
#.#......#
..........
##......#.
..........
##..#.##.#

Tile 3803:
##..#.#..#
#........#
#.........
....#...#.
#.#...##.#
#..##.....
###...#...
#.##.#.#.#
...#####.#
#..#.#....

Tile 2441:
.##..#.#.#
.........#
#..#..#.##
#...#...##
.....#..#.
...#.#...#
#........#
..##.#.#.#
#....#...#
.#..#..###

Tile 3373:
..###.....
...##....#
#...##....
.#........
#.......#.
..#.......
...#.#...#
#.....##..
..........
#####.#...

Tile 1721:
###.....##
#.........
...#......
#.....#...
..#......#
#........#
#..#....#.
#.......#.
.#....#...
#.##....#.

Tile 3499:
####...#.#
...##....#
#...#..#..
...#......
#.....##..
.........#
.#.......#
.#..#...##
#..#...##.
.#######..

Tile 3851:
#.##.#....
#..#....##
.#.##....#
.........#
#..#.#..#.
.....#...#
#.#.#....#
#.....#..#
####.....#
######.#.#

Tile 1181:
...#..####
....#....#
#.......##
##........
.##....#.#
..#......#
#.....#..#
.....#..#.
#..####..#
..#####.##

Tile 2269:
##.#...###
..##.#.#.#
##......##
.....#...#
.#.......#
#.#..##..#
##........
.#........
##.....#..
.##......#

Tile 2903:
.#.#.###..
.#..#.#..#
........#.
..#....#..
#.....#...
......###.
#.#....#..
#.#.#.#...
#........#
###.##...#

Tile 2927:
.##..####.
#.......#.
#........#
#.....##.#
##........
..#.......
#.......##
.##..#.#..
.......#..
...#..#..#

Tile 2083:
#.##.#..##
...#...##.
.......##.
...#..#...
###..#...#
##.......#
###.#.....
...#......
.#..#....#
...###..##

Tile 1621:
#.###.###.
..........
......##..
#.#....#.#
.#.#.###.#
#.........
#......#.#
#.#.##....
#...##...#
.#####....

Tile 2797:
........##
#..#.....#
..........
###.....##
#........#
#.........
#....####.
...#.###.#
......#.##
#...#.#.#.

Tile 1433:
.##..#....
#.....#.#.
.#.......#
..#..#.#.#
....#.....
#.#.......
..#.#..##.
#....#.#..
.........#
..#.##..##

Tile 1259:
.###...#..
#..#..#.##
#..#.#....
##..##.###
#.#...#.##
.......#.#
#.#....#.#
.##..##..#
.##..#....
.######.#.

Tile 1657:
#..##..##.
..###....#
###.......
.##.#....#
#.......##
##.#......
..........
#.#.....##
..#..#....
.#.#..#.##

Tile 3323:
..##.#####
....##..#.
#.#......#
#....#..##
#..#.....#
##........
.###.##...
.#.....###
...#..#..#
.##..###..

Tile 2203:
##....##.#
#.#.#..#.#
...#.##...
#....#.#.#
#.........
.##..#...#
#.....#.#.
.##.#..#.#
.#...#...#
...###....

Tile 2477:
#######...
..#....#..
#.........
#.#.....##
#...##....
...#.....#
#......#..
......#...
####.#..##
.#....####

Tile 3343:
#.#####.#.
....#..#..
........##
..#.##....
.#..#....#
.....#....
#.#.#....#
...#....##
#.##.#...#
.#..##..##

Tile 3821:
#.##..#..#
.........#
.#........
........#.
..#.......
#.##......
#......#..
....###.#.
#..#......
#.#.#.....

Tile 3347:
####....#.
#.........
#...#.....
.#..#.....
.#.......#
....#..#.#
.#.#.....#
...#......
.....##..#
.#######..

Tile 3877:
.#.#.####.
.......#.#
#.......#.
#..#.#.#.#
..#.#.#...
##.......#
....#...#.
..##..#..#
##.##..#..
#..#...#.#

Tile 3739:
.##.###.#.
#.##.....#
#.........
....#....#
#....#....
.#.#......
.#......#.
...#......
.........#
##.#.##.#.

Tile 3257:
..##.###..
.....##.##
#..###..##
.......#..
....#.....
..##......
#.#......#
#....#....
#...##....
#..####.#.

Tile 2969:
#.#.......
..#......#
...#.....#
.#.......#
#..#......
#..#.....#
#.#....##.
..#.....##
#..#.#..#.
...##.#..#

Tile 1097:
#####...#.
#..####..#
.##.#.##.#
#.......##
##.......#
#...#..#.#
#.......##
.......#..
......#...
..#.#.##.#

Tile 2011:
#.##.....#
#....#..##
.....#....
..##.#...#
#...#.....
...##.##..
###.##..##
#.#.##...#
#....#...#
#.##..#.##

Tile 1399:
#####..#.#
.###.#...#
#......#.#
...#.#....
##..#.#.#.
......#.##
......#..#
#..#.#....
#.#...#..#
##..####.#

Tile 3449:
.###..#...
.###..#.#.
..........
#.......##
...#..####
##.......#
.....#.#.#
#.#..#.#.#
.#...#..#.
#.##.#...#

Tile 2897:
#.#.......
..##......
#..#....##
.#........
#.#...#...
...#....##
#.##..#...
..#.#.....
.#.#......
.##..#..##

Tile 1153:
....#.#...
#.##.##..#
..#.##.#.#
.#...#.#..
..#...#...
......#.##
.#.......#
#.....#.#.
.#...#...#
.....#...#

Tile 2789:
#...####.#
##.#.....#
.......#..
......#..#
......#..#
..#.....##
....##..##
#...#.#..#
##...#.#..
..##.#....

Tile 1637:
.....#.#..
..#..#...#
#.....#.##
.#..#.....
#..#.....#
..#.#.##.#
.......#.#
....#.....
##.#.....#
##..#...#.

Tile 2029:
.#.#...#..
#...##...#
#.....##.#
##...#.##.
#.#..#....
#.....#...
#.........
..........
.#.###.#..
.#...####.

Tile 2239:
.####..#..
...#...#.#
##..#....#
..........
..#......#
.#........
##........
..........
..........
#..#####.#

Tile 2663:
.#...#...#
....#.#...
#....#...#
..##..###.
#....##...
##........
.#...#..##
.........#
.#...##.#.
..#...#...

Tile 1567:
..###.##..
#...#..#..
#.#......#
#......#..
#.#..#..##
.#..#.#..#
#.......#.
#.#.#...#.
....#....#
..#.....##

Tile 2467:
.#########
#..#......
#.#.....#.
.....#..#.
#...#....#
###.......
##...#.#.#
...#.#..##
#.....##.#
#..##.#..#

Tile 1447:
.#####..#.
...#..#...
.#..#..#..
...#.#.#.#
.#........
..#.......
#.......#.
#.##..#...
.........#
#####.##.#

Tile 3863:
.#...##..#
.#..#..#..
.........#
#......#.#
#...##....
.#........
#..##..#..
....#..##.
#.......##
.##...##..

Tile 3761:
..#....###
#.........
.#....#.##
##.......#
.........#
#.........
...#...#..
#......#..
......##..
#...##....

Tile 2027:
.##.#.##..
#.....#.##
....#....#
....#.#...
#.....#.#.
....#.#...
####......
.....##...
......#..#
....#...##

Tile 1279:
..#.#####.
#.#....#..
#.......#.
#.....#...
.#........
......##.#
#......#..
#.......##
.#...#....
.####..#..

Tile 1997:
#.#.#...#.
......#..#
###.......
#.......#.
#..#......
..#...#..#
...##.....
...#......
..........
..##...##.

Tile 3049:
..##.##...
.......#..
#...#....#
#..#.#....
.#..#.#.#.
.#.##...##
......#...
#..#....#.
..........
##...#.###

Tile 3209:
##..###.##
.....#..#.
#.#.#...##
#.#...#.##
....#...#.
..#.......
#....#..##
###...#...
#......#.#
##.#...###

Tile 3719:
####.##..#
.........#
..#.......
#.#.......
.##....##.
#.....#..#
.#.#..##.#
#.#.#.....
##..#.#.#.
..#...##..

Tile 3217:
..##.####.
...#.....#
.#.......#
.......#..
#...#.#...
..#.#..#..
.##......#
#.........
....#...##
..##..##.#

Tile 1913:
######.#.#
##....#.#.
.........#
#.#.#.....
#..##.#..#
#.....##.#
........##
........#.
#.....#...
###..##..#

Tile 2729:
.###.#..#.
..#..#...#
#..#.#.#..
.#...#...#
#......#..
...#..##.#
..........
.#........
#.#...##.#
##.####.#.

Tile 3089:
#...#.#.#.
..###.##..
#.#...##..
#......##.
..#...###.
#........#
.###..##.#
#..#......
#...#..#.#
#..#####..

Tile 3923:
.......##.
##.......#
#...#.#.#.
.......#..
.#.......#
#......##.
#.#...#..#
.....#..#.
#.....#...
.#..##.###

Tile 3229:
##..####.#
.....#..#.
#.#..#..#.
..........
.....#....
.........#
#.#.#.##.#
#.#.......
.#.#...###
##..#.#.#.

Tile 1571:
###....##.
.#.#..###.
##....####
..#.#..#..
.....#....
.#....#..#
....#.##.#
#..#.###.#
..#.....#.
.##..###.#

Tile 1063:
####.#####
.#....#...
#......#.#
........##
..##...#.#
##....#..#
#...##.#..
###.......
#....#...#
####.####.

Tile 1663:
..###.####
.....##..#
..#...##..
#..#..#...
#.#.......
...##.....
#....#.#.#
#.#..##...
.......#..
#.###.##..

Tile 1987:
..#...#...
....#...##
.#...#...#
..........
.#....#.##
####....#.
......#...
........##
#.....##.#
....###.#.

Tile 2803:
.##.#.##.#
#.#.....#.
#..#....#.
....#.#..#
...#..#...
#.#..##..#
.#.##..##.
..#...#.#.
#.##.#....
.#.###..##

Tile 1699:
.#.##.##.#
#.#.......
##.##.....
......##..
.#....#..#
..........
.........#
#...#.....
...###.##.
#....#####

Tile 1999:
..#..##..#
#..###...#
....##...#
.#....#...
.........#
#...#.....
.........#
#....#..##
..........
..#...####

Tile 1733:
#....#..##
##..#....#
#....#...#
###.......
#..#...#.#
.....#...#
.#.......#
.#....#..#
..#.#.#.##
......####

Tile 2273:
#...#..###
.#.##.#..#
###..##..#
##....#...
.....#..#.
...#..#...
#..#.#...#
#.........
..##...#..
.###.#.#..

Tile 1493:
##.#...##.
#...#...##
..#......#
##..#.....
##........
....#.....
#......###
......#...
##.....#..
#.#.#.....

Tile 3637:
..##.#.#..
#..###...#
....#..##.
##......#.
##.#.#...#
..#...#..#
#...#.....
..#..##...
.....#..##
.#.##...##

Tile 2333:
##.#...#..
#......###
..#.....##
.##......#
...##.##..
#..#.#.#..
....#.##.#
...#...#.#
.###....#.
.#.#.##..#

Tile 1201:
..#.#.####
..#...##..
#..##....#
#.#...#...
.....#....
...#....#.
....#....#
...#......
.##..##.##
###.#..##.

Tile 2243:
#..######.
.........#
...#....##
#...#..#..
#..#....#.
.....##...
.....#.#..
#........#
.#....#.##
####.#.#.#

Tile 1667:
##...##..#
....##...#
##..#..###
.....#..##
#........#
..#......#
#....#..##
#.........
##....##..
#..###...#

Tile 2053:
#.##.####.
#..##..##.
......#.##
.....#...#
#.##...#..
###.##..##
###.#..#..
#..#...#.#
#.#.#..###
#.#..####.

Tile 3407:
.##......#
#........#
......#..#
...#.#..##
#....##...
#....#..##
#...#....#
....#.###.
..#...#..#
..##.##.#.

Tile 2687:
###.#..#.#
...#####.#
##.#.....#
##.#......
...##..##.
#...#....#
#.........
#.........
#........#
..##.#....

Tile 1973:
##..#.###.
###..#.##.
####.....#
#...#.....
#....#...#
##.#....#.
#.#.##.#.#
###..#.#.#
##......#.
.#.....#..

Tile 2693:
.##.....#.
....#....#
#.#.#..#..
.##...#..#
##......##
##.#.#.##.
.#....#..#
....##...#
.#......##
...#.#.#..

Tile 2141:
....#####.
.........#
...#.#..##
.......#.#
#...#.#...
..........
...#......
..#.#.#...
#.#.#....#
.......###

Tile 1163:
##.#.##.##
#.....#.#.
.#.###....
..#..#..#.
#......#.#
#.......#.
.#...#.#..
.#...#..##
...#....##
...#.....#

Tile 1091:
##.##...##
#.........
....#.....
#........#
#...#.##.#
##.##.#..#
.........#
.........#
......#.##
####...###

Tile 2281:
...##...#.
....#...##
#..#.#...#
..#.#.....
###......#
.#......##
#........#
.......###
.....#....
##.#.#.##.

Tile 2767:
.##...#..#
..........
..#....##.
#..##....#
..#....#..
...##.#..#
..#####..#
#...###.##
#....#...#
###.##.##.

Tile 1697:
..###.#.#.
#####..#.#
...#...#.#
#.##...###
#.#..##...
......#..#
.##...####
..###.#...
#.##...#.#
#.#...#.#.

Tile 1409:
.######...
.##.....##
#....#..#.
....#...##
#...#.#.##
#..#....##
#......#.#
#...#..#.#
#.##......
.###.#..#.

Tile 3001:
###....#..
##.#..#..#
####..#...
#......#..
.#.#...##.
..#.#.##.#
..#...#.#.
####..##..
.........#
#..#.##...

Tile 1321:
..####.#.#
.##.......
...##.....
#......##.
##..#.....
.........#
##.##...##
#.##......
...#.#...#
##.###.#..

Tile 2707:
###.#..##.
.#....##.#
#...#..##.
#....#....
#.........
#...#.....
.##..#....
#.#..#..##
##....####
..#.##.##.

Tile 2689:
#.#.##.##.
.#......##
#...#...#.
..#...#...
..#......#
..#.#.##..
..........
....#.....
#........#
.#.#.####.

Tile 2551:
.........#
.#.......#
#..###...#
.#.#......
.........#
.#........
#..#....##
.#####....
#........#
.###..##..

Tile 1831:
##.#.#####
...#...###
#..#....#.
.#..#...#.
###......#
##..#..##.
#..#.....#
..#......#
..##.....#
#.....#.#.

Tile 2423:
##.#.#....
..........
#.........
##......#.
#.##.....#
##..#....#
....###..#
####.#..#.
####..#...
.#.#..###.

Tile 1373:
.#..##.#..
...#..#...
#......#..
#.##..#.##
..#..#....
##......##
#....#....
##..###...
#....#.#.#
#...#.###.

Tile 1123:
##.#..#..#
#.....#.##
#..##.##.#
#....#...#
..#.#.....
##.##.....
#...#..#.#
#..#.#....
..........
.###......

Tile 2647:
..#.##.##.
#......#.#
........#.
#....####.
..........
##....#.##
...#......
....#.....
.##.....#.
.#...##.##

Tile 2557:
...#..###.
.....##...
....##..#.
..#..#.#..
##....#..#
#.......#.
##......##
#.#..###..
.#.#.##...
.###.##..#

Tile 2003:
#..#...#..
#.#......#
..#.#.....
#.......##
.....#....
.....#...#
....##.#..
......#..#
...##.#..#
##....#.##

Tile 1051:
#..#....##
#..#...###
.......###
...##..#.#
#...#.....
#......##.
#.......#.
..##....##
.......#.#
.#.##..###

Tile 3613:
..#.#..##.
....#...#.
##.....#..
...#....##
.##..#...#
..#.#..#..
##..#.....
##..##...#
......##.#
##.#.##.#.

Tile 3529:
.#..#.#.##
.#.##..#..
##..##...#
#...#....#
...#....##
#........#
.#...#...#
...##.#...
#....##..#
##.#.#.#.#

Tile 1291:
#.#.##...#
..#.....#.
#.....#...
##.###.##.
.#.#.#....
.#...##.#.
..#...#.#.
.....#..#.
#...#..#..
#..#.#..#.

Tile 3023:
..#.#..#..
#...###...
.#.......#
.#..#.....
##........
.......#.#
#.......##
.....#...#
#.##......
.#.######.

Tile 1307:
##.###.##.
#.#..#....
.#....#...
#.#.....#.
...#.....#
....#.#...
#........#
##....#...
...#......
.#.##.....

Tile 1301:
###.####.#
.....#....
..#..#.#..
..##..#..#
#.#.#....#
.#...#..##
#....#..#.
.#.###....
.##.#..#.#
...####..#

Tile 3769:
#.#.....#.
.........#
...##...#.
......##..
#........#
#...#.....
.#..#..###
....#...#.
#......#.#
###....#.#

Tile 3727:
..##.##.#.
.........#
...#.#...#
#..#.####.
#..#..#..#
#..#..##..
....##...#
#..#.#...#
...#......
.#.#.##.##

Tile 2851:
..#...##.#
.#.##.#...
##.....#.#
..##.#...#
##....#..#
#..#..##.#
#.##.#.###
.....##...
...#.#....
..##..####

Tile 1787:
.#..#....#
#..#.#...#
#........#
.......#..
...#.....#
#.....#..#
#..#....##
#.....#.##
##.......#
....###..#

Tile 2957:
#.##..#..#
#..#.##.#.
.......#..
..##.##...
...#.....#
.##....#..
...#...#..
.#.##..##.
#..#......
...#.##.#.

Tile 1453:
.#..#.....
#..#......
.#......#.
##..#.#..#
......#...
#####...##
##...#..#.
#.....#.##
.....###..
####.#....

Tile 1549:
.###......
......#..#
#..#.#.#.#
##...#....
#.#.##..#.
#...#...##
........#.
##....#..#
.#...###..
##.##..###
`
